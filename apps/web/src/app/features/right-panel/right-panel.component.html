<section class="right-panel" [class.sheet-expanded]="bottomSheetExpanded()">
  @let session = sessionState();
  @let view = viewState();
  @if (mode() === "edit") {
    <app-search-criteria-panel
      [session]="session"
      [querySuggestions]="querySuggestions()"
      [isQuerySuggesting]="isQuerySuggesting()"
      [destinationSuggestions]="destinationSuggestions()"
      [isDestinationSuggesting]="isDestinationSuggesting()"
      [dayOptions]="dayOptions"
      [timeOptions]="timeOptions"
      [travelStatus]="view.travelStatus"
      [travelMessage]="view.travelMessage"
      (queryUpdated)="onQueryUpdated($event)"
      (queryKey)="onQueryKey($event)"
      (queryCandidateSelected)="onQueryCandidateSelected($event)"
      (runSearch)="onSearch()"
      (travelEnabledChange)="onTravelEnabledChange($event)"
      (destinationInputChange)="onDestinationInputChange($event)"
      (destinationKey)="onDestinationKey($event)"
      (destinationCandidateSelected)="onDestinationCandidateSelected($event)"
      (travelModeChange)="onTravelModeChange($event)"
      (travelDayChange)="onTravelDayChange($event)"
      (travelTimeChange)="onTravelTimeChange($event)"
      (applyTravel)="onApplyTravel()"
    ></app-search-criteria-panel>
  } @else {
    <app-criteria-summary-bar
      [chips]="summaryChips()"
      (editRequested)="onEdit()"
    ></app-criteria-summary-bar>
  }

  @if (mode() === "results") {
    <div class="results-wrap" [class.has-sheet]="selectedZoneId()">
      <app-zone-results-list
        [rows]="view.rows"
        [travelStatus]="view.travelStatus"
        [selectedZoneId]="selectedZoneId()"
        (hovered)="onHover($event)"
        (selected)="onSelect($event)"
      ></app-zone-results-list>
    </div>
  }

  @if (selectedZoneId()) {
    <app-zone-details-bottom-sheet
      [summary]="detailsSummary()"
      [detailsState]="detailsState()"
      [travelLabel]="formatTravel(selectedTravel(), view.travelStatus)"
      [aggregateState]="rentAggregateState()"
      [expanded]="bottomSheetExpanded()"
      (toggleExpanded)="toggleBottomSheet()"
    ></app-zone-details-bottom-sheet>
  }
</section>
