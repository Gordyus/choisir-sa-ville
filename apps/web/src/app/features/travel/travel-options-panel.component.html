<div class="detail-card">
  <h3 class="detail-title">Travel options</h3>
  <div class="detail-meta">
    <label class="toggle">
      <input
        type="checkbox"
        [ngModel]="travelEnabled"
        (ngModelChange)="travelEnabledChange.emit($event)"
      />
      <span>Enable travel time</span>
    </label>
    <label>
      <span>Destination address</span>
      <input
        type="text"
        name="destination"
        placeholder="10 Rue de la Paix, Paris"
        [disabled]="!travelEnabled"
        [value]="destinationInput"
        (input)="onDestinationInput($event)"
        (keydown)="destinationKey.emit($event)"
      />
    </label>
    @if (travelEnabled && destinationSuggestions.length > 0) {
      <ul class="geocode-suggestions">
        @for (candidate of destinationSuggestions; track candidate.label; let i = $index) {
          <li
            [class.active]="i === suggestionIndex"
            (click)="candidateSelected.emit(candidate)"
          >
            {{ candidate.label }}
          </li>
        }
      </ul>
    }
    <label>
      <span>Mode</span>
      <select
        name="mode"
        [ngModel]="travelMode"
        (ngModelChange)="modeChange.emit($event)"
        [disabled]="!travelEnabled"
      >
        <option value="car">Car</option>
        <option value="transit">Transit</option>
      </select>
    </label>
    <label>
      <span>Arrive day</span>
      <select
        name="travelDay"
        [ngModel]="travelDay"
        [disabled]="!travelEnabled"
        (ngModelChange)="dayChange.emit($event)"
      >
        @for (day of dayOptions; track day.value) {
          <option [value]="day.value">{{ day.label }}</option>
        }
      </select>
    </label>
    <label>
      <span>Arrive time</span>
      <select
        name="travelTime"
        [ngModel]="travelTime"
        [disabled]="!travelEnabled"
        (ngModelChange)="timeChange.emit($event)"
      >
        @for (time of timeOptions; track time) {
          <option [value]="time">{{ time }}</option>
        }
      </select>
    </label>
    <button type="button" (click)="applyTravel.emit()" [disabled]="!travelEnabled">
      Apply travel
    </button>
    <span class="hint">Type an address near your search area (lat,lng also works).</span>
    @if (isSuggesting) {
      <span class="hint">Searching addresses...</span>
    }
    @if (isGeocoding) {
      <span class="hint">Looking up address...</span>
    }
    @if (resolvedDestinationLabel) {
      <span class="hint">Resolved: {{ resolvedDestinationLabel }}</span>
    }
    @if (travelError) {
      <span class="error">{{ travelError }}</span>
    }
    @if (travelEnabled && travelStatus === "loading") {
      <span class="hint">Loading travel times...</span>
    }
    @if (!travelError && travelEnabled && travelStatus === "error") {
      <span class="error">
        {{ travelMessage ?? "Travel service unavailable." }}
      </span>
    }
  </div>
</div>
